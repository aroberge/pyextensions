<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Modules &#8212; pyextensions 0.1 documentation</title>
    
    <link rel="stylesheet" href="_static/readable.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '0.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Motivation for pyextensions" href="motivation.html" />
   
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9">

  </head>
  <body role="document">
  
  

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="motivation.html" title="Motivation for pyextensions"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">pyextensions 0.1 documentation</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="modules">
<h1>Modules<a class="headerlink" href="#modules" title="Permalink to this headline">¶</a></h1>
<div class="section" id="module-pyextensions.import_hook">
<span id="import-hook"></span><h2>import_hook<a class="headerlink" href="#module-pyextensions.import_hook" title="Permalink to this headline">¶</a></h2>
<p>A custom importer making use of the import hook capability</p>
<dl class="class">
<dt id="pyextensions.import_hook.ExtensionLoader">
<em class="property">class </em><code class="descclassname">pyextensions.import_hook.</code><code class="descname">ExtensionLoader</code><span class="sig-paren">(</span><em>filename</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyextensions/import_hook.html#ExtensionLoader"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyextensions.import_hook.ExtensionLoader" title="Permalink to this definition">¶</a></dt>
<dd><p>A custom loader which will transform the source prior to its execution</p>
<dl class="method">
<dt id="pyextensions.import_hook.ExtensionLoader.exec_module">
<code class="descname">exec_module</code><span class="sig-paren">(</span><em>module</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyextensions/import_hook.html#ExtensionLoader.exec_module"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyextensions.import_hook.ExtensionLoader.exec_module" title="Permalink to this definition">¶</a></dt>
<dd><p>import the source code, transforma it before executing it so that
it is known to Python.</p>
</dd></dl>

<dl class="method">
<dt id="pyextensions.import_hook.ExtensionLoader.write_html_diff">
<code class="descname">write_html_diff</code><span class="sig-paren">(</span><em>name</em>, <em>original</em>, <em>transformed</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyextensions/import_hook.html#ExtensionLoader.write_html_diff"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyextensions.import_hook.ExtensionLoader.write_html_diff" title="Permalink to this definition">¶</a></dt>
<dd><p>Writes an html file showing the difference between the original
and the transformed source.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="pyextensions.import_hook.ExtensionMetaFinder">
<em class="property">class </em><code class="descclassname">pyextensions.import_hook.</code><code class="descname">ExtensionMetaFinder</code><a class="reference internal" href="_modules/pyextensions/import_hook.html#ExtensionMetaFinder"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyextensions.import_hook.ExtensionMetaFinder" title="Permalink to this definition">¶</a></dt>
<dd><p>A custom finder to locate modules.  The main reason for this code
is to ensure that our custom loader, which does the code transformations,
is used.</p>
<dl class="method">
<dt id="pyextensions.import_hook.ExtensionMetaFinder.find_spec">
<code class="descname">find_spec</code><span class="sig-paren">(</span><em>fullname</em>, <em>path</em>, <em>target=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyextensions/import_hook.html#ExtensionMetaFinder.find_spec"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyextensions.import_hook.ExtensionMetaFinder.find_spec" title="Permalink to this definition">¶</a></dt>
<dd><p>finds the appropriate properties (spec) of a module, and sets
its loader.</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="pyextensions.import_hook.import_main">
<code class="descclassname">pyextensions.import_hook.</code><code class="descname">import_main</code><span class="sig-paren">(</span><em>name</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyextensions/import_hook.html#import_main"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyextensions.import_hook.import_main" title="Permalink to this definition">¶</a></dt>
<dd><p>Imports the module that is to be interpreted as the main module.</p>
<p>pyextensions is often invoked with a script meant to be run as the
main module its source is transformed with the -s (or &#8211;source) option,
as in:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="o">-</span><span class="n">m</span> <span class="n">pyextensions</span> <span class="o">-</span><span class="n">s</span> <span class="n">name</span>
</pre></div>
</div>
<p>Python identifies pyextensions as the main script; we artificially
change this so that &#8220;main_script&#8221; is properly identified as <code class="docutils literal"><span class="pre">name</span></code>.</p>
</dd></dl>

</div>
<div class="section" id="module-pyextensions.transforms">
<span id="transforms"></span><h2>transforms<a class="headerlink" href="#module-pyextensions.transforms" title="Permalink to this headline">¶</a></h2>
<p>This module takes care of identifying, importing and adding source
code transformers. It also contains a function, <cite>transform</cite>, which
takes care of invoking all known transformers to convert a source code.</p>
<dl class="class">
<dt id="pyextensions.transforms.NullTransformer">
<em class="property">class </em><code class="descclassname">pyextensions.transforms.</code><code class="descname">NullTransformer</code><a class="reference internal" href="_modules/pyextensions/transforms.html#NullTransformer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyextensions.transforms.NullTransformer" title="Permalink to this definition">¶</a></dt>
<dd><p>NullTransformer is a convenience class which can generate instances
to be used when a given transformer cannot be imported.</p>
</dd></dl>

<dl class="function">
<dt id="pyextensions.transforms.add_all_imports">
<code class="descclassname">pyextensions.transforms.</code><code class="descname">add_all_imports</code><span class="sig-paren">(</span><em>source</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyextensions/transforms.html#add_all_imports"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyextensions.transforms.add_all_imports" title="Permalink to this definition">¶</a></dt>
<dd><p>Some transformers may require that other modules be imported
in the source code for it to work properly.</p>
</dd></dl>

<dl class="function">
<dt id="pyextensions.transforms.add_transformers">
<code class="descclassname">pyextensions.transforms.</code><code class="descname">add_transformers</code><span class="sig-paren">(</span><em>line</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyextensions/transforms.html#add_transformers"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyextensions.transforms.add_transformers" title="Permalink to this definition">¶</a></dt>
<dd><p>Extract the transformers names from a line of code of the form
#ext transformer1 [transformer2]
and adds them to the globally known dict</p>
</dd></dl>

<dl class="function">
<dt id="pyextensions.transforms.apply_ast_transformations">
<code class="descclassname">pyextensions.transforms.</code><code class="descname">apply_ast_transformations</code><span class="sig-paren">(</span><em>source</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyextensions/transforms.html#apply_ast_transformations"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyextensions.transforms.apply_ast_transformations" title="Permalink to this definition">¶</a></dt>
<dd><p>Used to convert the source code into an AST tree and applying
all AST transformer specified in the source code. It returns
a (potentially transformed) AST tree.</p>
<p>&#8220;AST transformers&#8221; are modules which must contain a function</p>
<blockquote>
<div>transform_ast(tree)</div></blockquote>
<p>which return another AST tree.</p>
</dd></dl>

<dl class="function">
<dt id="pyextensions.transforms.apply_source_transformations">
<code class="descclassname">pyextensions.transforms.</code><code class="descname">apply_source_transformations</code><span class="sig-paren">(</span><em>source</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyextensions/transforms.html#apply_source_transformations"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyextensions.transforms.apply_source_transformations" title="Permalink to this definition">¶</a></dt>
<dd><p>Used to convert the source code, making use of known transformers.</p>
<p>&#8220;transformers&#8221; are modules which must contain a function</p>
<blockquote>
<div>transform_source(source)</div></blockquote>
<p>which returns a tranformed source.
Some transformers (for example, those found in the standard library
module lib2to3) cannot cope with non-standard syntax; as a result, they
may fail during a first attempt. We keep track of all failing
transformers and keep retrying them until either they all succeeded
or a fixed set of them fails twice in a row.</p>
</dd></dl>

<dl class="function">
<dt id="pyextensions.transforms.identify_requested_transformers">
<code class="descclassname">pyextensions.transforms.</code><code class="descname">identify_requested_transformers</code><span class="sig-paren">(</span><em>source</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyextensions/transforms.html#identify_requested_transformers"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyextensions.transforms.identify_requested_transformers" title="Permalink to this definition">¶</a></dt>
<dd><p>Scan a source for lines of the form:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="c1">#ext transformer1 [transformer2 ...]</span>
</pre></div>
</div>
<p>identifying transformers to be used and ensure that they are imported.</p>
</dd></dl>

<dl class="function">
<dt id="pyextensions.transforms.import_transformer">
<code class="descclassname">pyextensions.transforms.</code><code class="descname">import_transformer</code><span class="sig-paren">(</span><em>name</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyextensions/transforms.html#import_transformer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyextensions.transforms.import_transformer" title="Permalink to this definition">¶</a></dt>
<dd><p>If needed, import a transformer, and adds it to the globally known dict
The code inside a module where a transformer is defined should be
standard Python code, which does not need any transformation.
So, we disable the import hook, and let the normal module import
do its job - which is faster and likely more reliable than our
custom method.</p>
</dd></dl>

</div>
<div class="section" id="module-pyextensions.console">
<span id="console"></span><h2>console<a class="headerlink" href="#module-pyextensions.console" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="pyextensions.console.PyextensionsInteractiveConsole">
<em class="property">class </em><code class="descclassname">pyextensions.console.</code><code class="descname">PyextensionsInteractiveConsole</code><span class="sig-paren">(</span><em>locals=None</em>, <em>show_python=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyextensions/console.html#PyextensionsInteractiveConsole"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyextensions.console.PyextensionsInteractiveConsole" title="Permalink to this definition">¶</a></dt>
<dd><p>A Python console that tries to emulate the normal Python interpreter
except that it support experimental code transformations.
It inherits from cPython&#8217;s <code class="docutils literal"><span class="pre">code.InteractiveConsole</span></code>.</p>
<p>Like the normal Python&#8217;s interactive console, it attempts to evaluate
code entered one line at a time by a user.</p>
<dl class="method">
<dt id="pyextensions.console.PyextensionsInteractiveConsole.do_transformations">
<code class="descname">do_transformations</code><span class="sig-paren">(</span><em>source</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyextensions/console.html#PyextensionsInteractiveConsole.do_transformations"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyextensions.console.PyextensionsInteractiveConsole.do_transformations" title="Permalink to this definition">¶</a></dt>
<dd><p>Performs the source and AST transformations on the current content.</p>
<p>Returns the transformed source.</p>
</dd></dl>

<dl class="method">
<dt id="pyextensions.console.PyextensionsInteractiveConsole.fix_ending">
<code class="descname">fix_ending</code><span class="sig-paren">(</span><em>source</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyextensions/console.html#PyextensionsInteractiveConsole.fix_ending"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyextensions.console.PyextensionsInteractiveConsole.fix_ending" title="Permalink to this definition">¶</a></dt>
<dd><p>Ensures that the last blank lines of the transformed source are 
consistent with what was provided by the user.</p>
</dd></dl>

<dl class="method">
<dt id="pyextensions.console.PyextensionsInteractiveConsole.push">
<code class="descname">push</code><span class="sig-paren">(</span><em>line</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyextensions/console.html#PyextensionsInteractiveConsole.push"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyextensions.console.PyextensionsInteractiveConsole.push" title="Permalink to this definition">¶</a></dt>
<dd><p>Pushes a transformed line to the interpreter.</p>
<p>The line should not have a trailing newline; it may have
internal newlines.  The line is transformed and appended to a buffer.
The interpreter&#8217;s runsource() method is called with the
concatenated contents of the buffer as source.  If this
indicates that the command was executed or invalid, the buffer
is reset; otherwise, the command is incomplete, and the buffer
is left as it was after the line was appended.  The return
value is 1 if more input is required, 0 if the line was dealt
with in some way (this is the same as runsource()).</p>
</dd></dl>

<dl class="method">
<dt id="pyextensions.console.PyextensionsInteractiveConsole.show_converted">
<code class="descname">show_converted</code><span class="sig-paren">(</span><em>source</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyextensions/console.html#PyextensionsInteractiveConsole.show_converted"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyextensions.console.PyextensionsInteractiveConsole.show_converted" title="Permalink to this definition">¶</a></dt>
<dd><p>Prints the converted source</p>
</dd></dl>

<dl class="method">
<dt id="pyextensions.console.PyextensionsInteractiveConsole.showsyntaxerror">
<code class="descname">showsyntaxerror</code><span class="sig-paren">(</span><em>filename=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyextensions/console.html#PyextensionsInteractiveConsole.showsyntaxerror"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyextensions.console.PyextensionsInteractiveConsole.showsyntaxerror" title="Permalink to this definition">¶</a></dt>
<dd><p>Shows the converted source if different than the original 
and the syntax error</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="pyextensions.console.start_console">
<code class="descclassname">pyextensions.console.</code><code class="descname">start_console</code><span class="sig-paren">(</span><em>local_vars=None</em>, <em>show_python=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyextensions/console.html#start_console"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyextensions.console.start_console" title="Permalink to this definition">¶</a></dt>
<dd><p>Starts a console; modified from code.interact</p>
</dd></dl>

</div>
<div class="section" id="unparse">
<h2>unparse<a class="headerlink" href="#unparse" title="Permalink to this headline">¶</a></h2>
<p>Unparse is a module that is part of the cPython repository,
available under the Tools directory. Because of its location,
it is not available for import by Python programs and has been
copied in the pyextensions repository since we use it for some
AST transformations.</p>
<p>The original can be found at
<a class="reference external" href="https://github.com/python/cpython/blob/master/Tools/parser/unparse.py">https://github.com/python/cpython/blob/master/Tools/parser/unparse.py</a></p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Modules</a><ul>
<li><a class="reference internal" href="#module-pyextensions.import_hook">import_hook</a></li>
<li><a class="reference internal" href="#module-pyextensions.transforms">transforms</a></li>
<li><a class="reference internal" href="#module-pyextensions.console">console</a></li>
<li><a class="reference internal" href="#unparse">unparse</a></li>
</ul>
</li>
</ul>
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation index</a><ul>
      <li>Previous: <a href="motivation.html" title="previous chapter">Motivation for pyextensions</a></li>
  </ul></li>
</ul>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/modules.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
  <div class="footer">
    &copy; Copyright 2018, André Roberge.
    Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.5.6.
  </div>
  
  </body>
</html>